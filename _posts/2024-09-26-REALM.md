---
title: "[Paper Review] REALM: Retrieval-Augmented Language Model Pre-Training"
description: "Paper Review for REALM"
writer: Sangyun Won
categories: [AI, Paper Review]
tags: [AI]
image:
  path: https://github.com/user-attachments/assets/e0f3409d-c116-47f5-bab3-0fc367d9e2cf
  alt: Paper Review for REALM

math: true
toc: true
toc_sticky: true

date: 2024-09-26
last_modified_at: 2024-09-26
---

<style>
  figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}
.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}
</style>

<figure>
  <a href="https://arxiv.org/pdf/2002.08909" class="bookmark source">
    <div class="bookmark-info">
      <div class="bookmark-text">
        <div class="bookmark-title">REALM: Retrieval-Augmented Language Model Pre-Training</div>
        <div class="bookmark-description">arxiv pdf link for REALM</div>
      </div>
    </div>
  </a>
</figure>

## 0. Abstract ğŸ¬
ì§€ê¸ˆê¹Œì§€ ì—¬ëŸ¬ LM pre-training ì€ ì—„ì²­ë‚˜ê²Œ ë§ì€ ì–‘ì˜ ì§€ì‹ì„ í•™ìŠµí•˜ê¸° ìœ„í•´ì„œ ì§„í–‰ë˜ì–´ ì™”ìœ¼ë©°, ì´ëŠ” NLP task ì¤‘ì—ì„œë„ QA task ì— ë§¤ìš° ì¤‘ëŒ€í•œ ì˜í–¥ì„ ì£¼ì—ˆë‹¤. í•˜ì§€ë§Œ, ì´ ì§€ì‹ë“¤ì€ ì•”ì‹œì ìœ¼ë¡œ ëª¨ë¸ì˜ íŒŒë¼ë¯¸í„°ì— ì €ì¥ë˜ì–´ ìˆìœ¼ë©°, ë” ë§ì€ ì§€ì‹ì„ í•™ìŠµí•˜ê¸° ìœ„í•´ì„œëŠ” ë” í° network ì´ í•„ìš”í•˜ë‹¤. ì§€ì‹ì„ ë”ìš± í•´ì„ ê°€ëŠ¥í•˜ê³ , ì¼ë°˜ì ìœ¼ë¡œ ì €ì¥í•˜ê¸° ìœ„í•´ì„œëŠ”, latent knowledge retriever, ì¦‰ ë‹¤ë¥¸ large corpus ë‚´ë¶€ì˜ document ì—ì„œ retrieve í•´ì£¼ëŠ” ëª¨ë¸ì´ í•„ìš”í•˜ë‹¤. 

ì²˜ìŒìœ¼ë¡œ ë³¸ ë…¼ë¬¸ì—ì„œëŠ” masked language ëª¨ë¸ë§ ë°©ì‹ìœ¼ë¡œ knowledge retriever ì„ unsupervised ë°©ì‹ìœ¼ë¡œ í•™ìŠµì‹œí‚¤ëŠ” ê²ƒì„ ë³´ì¼ ê²ƒì´ê³ , ì´ë¥¼ ì—­ì „íŒŒë¥¼ í†µí•´ í•™ìŠµí•˜ëŠ” ê³¼ì •ê¹Œì§€ ë³´ì¼ ê²ƒì´ë‹¤. ë³¸ ë…¼ë¬¸ì—ì„œëŠ” Retrieval-Augmented Language Model pre-training ì„ OPQA ì— ì ìš©ì‹œí‚¬ ê²ƒì´ê³ , ëª…ì‹œì  ì§€ì‹ê³¼ ì•”ì‹œì  ì§€ì‹ì— ëŒ€í•´ì„œ ë‹¤ë¥¸ SOTA ëª¯ë¸ë“¤ê³¼ ë¹„êµí•˜ì—¬ ë‹¤ë¥¸ ëª¨ë¸ë“¤ì˜ ì„±ëŠ¥ì„ ëŠ¥ê°€í•¨ì„ ë³´ì¼ ê²ƒì´ë‹¤. 

## 1. Introduction â˜•ï¸
ìµœê·¼ BERT, RoBERTa, T5ì™€ ê°™ì€ ë‹¤ì–‘í•œ LM ì˜ pre-trainingì€ ì—„ì²­ë‚œ ì–‘ì˜ world knowledge ë¥¼ ì €ì¥í•˜ê³  ìˆìœ¼ë©°, ì´ëŠ” ê·¸ ëª¨ë¸ë“¤ì´ í•™ìŠµí•œ ì—„ì²­ë‚œ ì–‘ì˜ text ë°ì´í„°ì— ê¸°ë°˜í•œë‹¤. 

ì˜ˆë¥¼ ë“¤ì–´
> "The ____ is the currency of the United Kingdom". (answer : pound)

ì´ë¼ëŠ” ë¬¸ì¥ì—ì„œ ì†ì‰½ê²Œ ë§ˆìŠ¤í‚¹ëœ ë‹¨ì–´ë¥¼ ì˜ˆì¸¡í•´ë‚¼ ìˆ˜ ìˆë‹¤. 

ì´ëŸ° LMë“¤ì˜ ê²½ìš°, world knowledgge ë¥¼ íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ ì•”ì‹œì ìœ¼ë¡œ ì €ì¥í•˜ë©°, ì´ëŠ” ê·¸ ì§€ì‹ì´ ì–´ë–»ê²Œ, ì–´ë””ì— ì €ì¥ë˜ì–´ ìˆëŠ”ì§€ë¥¼ íŒŒì•…í•˜ê¸°ê°€ ì–´ë µë‹¤. ë” ë‚˜ì•„ê°€, store space ëŠ” í•œì •ì ì´ê¸° ë•Œë¬¸ì—, ë” ë§ì€ ì§€ì‹ì„ ìœ„í•´ì„œëŠ” ë” í° ë„¤íŠ¸ì›Œí¬ê°€ í•„ìˆ˜ì ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤. 

<img src="https://github.com/user-attachments/assets/e0f3409d-c116-47f5-bab3-0fc367d9e2cf" height="400px" width="500px" alt="figure 1">

ë³´ë‹¤ ë” ë§ì€ ì§€ì‹ì„ ì €ì¥í•˜ê³ , í•´ì„ ê°€ëŠ¥í•œ ë°©ì‹ì„ ìœ„í•´ì„œ ë³¸ ë…¼ë¬¸ì—ì„œëŠ” REALM (Retrieval-Augmented Language Model) ì„ ì†Œê°œí•œë‹¤. ì´ ë°©ì‹ì€ learned textual knowledge retriever ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì˜ pre-traing ë°©ì‹ì„ ì¦ì§„ì‹œí‚¨ë‹¤. ë‹¤ë¥¸ ëª¨ë¸ë“¤ê³¼ëŠ” ë°˜ëŒ€ë¡œ ì´ ëª¨ë¸ì€ inference ì‹œì— ì–´ë–¤ ì •ë³´ë¥¼ retrieve í•˜ê³  ì‚¬ìš©í•  ê²ƒì¸ì§€ë¥¼ ìš”ì²­í•˜ì—¬ ì§€ì‹ì˜ ëª…ì‹œì  ì ‘ê·¼ì„ ì ìš©í•œë‹¤. ê° prediction ì „ì—, retriever ì„ ì‚¬ìš©í•˜ì—¬ ë§¤ìš° í° corpus ë‚´ë¶€ì˜ documnet ë¥¼ ê²€ìƒ‰í•˜ê²Œ ë˜ê³ , ì´ document ë¥¼ í™œìš©í•˜ì—¬ ì§ˆë¬¸ì— ëŒ€í•œ ë‹µì„ ìƒì„±í•´ë‚¸ë‹¤. ì´ ëª¨ë¸ì„ end-to-end ë°©ì‹ìœ¼ë¡œ í•™ìŠµí•˜ëŠ” ê²ƒì€ retriever ì— ëŒ€í•œ backpropagation ì„ ìš”êµ¬í•˜ë©°, ì´ëŠ” ê³§ ì „ì²´ corpus ì— ëŒ€í•œ ì ‘ê·¼ì´ í•„ìš”í•˜ë‹¤. 

ì´ REALM ë°©ì‹ì— ëŒ€í•œ key intuition ì€ retriever ì„ í•™ìŠµì‹œí‚¬ ë•Œ, unsupervised-text ê¸°ë°˜ì˜ performance-based signal ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤. ì´ ë°©ì‹ì€ LMì˜ perplexity ë¥¼ í–¥ìƒì‹œí‚¤ëŠ” retrieval ì— ëŒ€í•´ì„œ reward ë¥¼ ë¶€ì—¬í•˜ê²Œ ëœë‹¤. 

ì˜ˆë¥¼ ë“¤ì–´, *"the ____ at the top of the pyramid"* ë¼ëŠ” ë¬¸ì¥ì´ ì¡´ì¬í•˜ê³ , ë§ˆìŠ¤í‚¹ëœ í† í°ì„ predict í•˜ê³ ì í•  ë•Œ, retrieverì€ ë‹¤ìŒê³¼ ê°™ì€ document ë¥¼ retrieve í•  ë•Œ rewarded ë˜ê²Œ ëœë‹¤. 

> "The pyramidion on top allows for less material higher up the pyramid"

ë³¸ ë…¼ë¬¸ì—ì„œëŠ” latent variable LMì— ëŒ€í•œ retrieve-then-predict ì ‘ê·¼ì˜ ëª¨ë¸ë§ì„ í†µí•´ì„œ marginal likelihood ë¥¼ ìµœì í™”ì‹œí‚¤ëŠ” ë°©í–¥ì„ í•™ìŠµí•˜ê²Œ ëœë‹¤. 